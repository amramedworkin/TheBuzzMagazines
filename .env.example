# ============================================================================
# TheBuzzMagazines Environment Configuration
# ============================================================================
#
# VARIABLE GROUP OVERVIEW:
# ------------------------
# GLOBAL_*                    - Global prefix and password settings
# AZURE_PROVISION_MYSQL_*     - Azure infrastructure creation (az cli)
# AZURE_RESOURCE_*            - Azure resource naming and location
# AZURE_STORAGE_*             - Azure Files storage account
# AZURE_ACR_*                 - Azure Container Registry
# AZURE_CONTAINER_*           - Azure Container Apps
# DOCKER_*                    - Docker build configuration (template generation)
# SUITECRM_RUNTIME_MYSQL_*    - Docker container DB connection (runtime)
# SUITECRM_*                  - SuiteCRM application settings
# MIGRATION_SOURCE_MYSQL_*    - Legacy MySQL DB to read FROM during migration
# MIGRATION_DEST_MYSQL_*      - SuiteCRM MySQL DB to write TO during migration
# BUZZ_ADVERT_MSACCESS_*      - Legacy MS Access database (if direct access needed)
#
# NOTE: SuiteCRM's actual configuration files (config.php, config_override.php)
# are generated inside the Docker container at runtime by docker-entrypoint.sh.
# Those files are ephemeral and outside the scope of this .env file.
#
# See docs/ENV_GUIDE.md for detailed documentation.
# ============================================================================

# ============================================================================
# GLOBAL CONFIGURATION
# ============================================================================
# Global settings for consistent naming and passwords across all services.
# These are the SINGLE SOURCE OF TRUTH for prefixes and passwords.
# ============================================================================

# Global naming prefix - used by Azure and Docker resources
# Keep short (3-8 chars), lowercase, alphanumeric only
GLOBAL_PREFIX=buzzmag

# Global default password for development environments
# ⚠️  DEVELOPMENT ONLY: In production, override individual passwords below!
# Password meets Azure MySQL requirements: 8+ chars, mixed case, numbers, special
GLOBAL_PASSWORD=[YOUR_GLOBAL_PASSWORD_HERE]

# ============================================================================
# DERIVED PREFIXES
# ============================================================================
# These inherit from GLOBAL_PREFIX to ensure consistent naming across services.
# ============================================================================
AZURE_RESOURCE_PREFIX=${GLOBAL_PREFIX}
DOCKER_PREFIX=${GLOBAL_PREFIX}

# ============================================================================
# DERIVED PASSWORDS
# ============================================================================
# These inherit from GLOBAL_PASSWORD for simplified development setup.
#
# ⚠️  PRODUCTION SECURITY: Uncomment and customize each password for production.
#     Each service should have a UNIQUE password in production environments.
# ============================================================================

# SuiteCRM password (used for DB, admin, and migration destination)
SUITECRM_PASSWORD=[YOUR_SUITECRM_PASSWORD_HERE]
# Production override (uncomment and customize):
# SUITECRM_PASSWORD=YourUniqueSuiteCRMPwd1!

# Azure-specific password (for Azure MySQL admin)
AZURE_PASSWORD=[YOUR_AZURE_PASSWORD_HERE]
# Production override (uncomment and customize):
# AZURE_PASSWORD=YourUniqueAzurePwd2@

# Docker-specific password (if needed for container-level auth)
DOCKER_PASSWORD=[YOUR_DOCKER_PASSWORD_HERE]
# Production override (uncomment and customize):
# DOCKER_PASSWORD=YourUniqueDockerPwd3#

# ============================================================================
# AZURE RESOURCE CONFIGURATION
# ============================================================================
# Core Azure settings: subscription, region, and naming conventions.
# Used by: scripts/azure-provision.sh
# ============================================================================
# Azure subscription ID (GUID from Azure Portal > Subscriptions)
AZURE_SUBSCRIPTION_ID=[YOUR_AZURE_SUBSCRIPTION_ID_HERE]
AZURE_LOCATION=southcentralus
AZURE_RESOURCE_GROUP=${AZURE_RESOURCE_PREFIX}-rg

# ============================================================================
# AZURE PROVISIONING: MYSQL FLEXIBLE SERVER
# ============================================================================
# Settings for CREATING the Azure MySQL server via az cli.
# These control the infrastructure (SKU, storage, version).
# Used by: scripts/azure-provision.sh
# ============================================================================
AZURE_PROVISION_MYSQL_SERVER_NAME=${AZURE_RESOURCE_PREFIX}-mysql
AZURE_PROVISION_MYSQL_SKU=Standard_B1s
AZURE_PROVISION_MYSQL_STORAGE_GB=20
AZURE_PROVISION_MYSQL_VERSION=8.4

# ============================================================================
# AZURE STORAGE ACCOUNT (Azure Files)
# ============================================================================
# Persistent file storage for SuiteCRM uploads, customizations, cache.
# Used by: scripts/azure-provision.sh, scripts/azure-mount.sh
# ============================================================================
AZURE_STORAGE_ACCOUNT_NAME=${AZURE_RESOURCE_PREFIX}storage
AZURE_STORAGE_SKU=Standard_LRS

# Azure Files share configuration
AZURE_FILES_SHARE_PREFIX=${DOCKER_PREFIX}-suitecrm
AZURE_FILES_SHARE_UPLOAD=upload
AZURE_FILES_SHARE_CUSTOM=custom
AZURE_FILES_SHARE_CACHE=cache
AZURE_FILES_CREDENTIALS_FILE=/etc/azure-${GLOBAL_PREFIX}-credentials

# ============================================================================
# AZURE CONTAINER REGISTRY
#================================================================
# Docker image repository in Azure.
# Used by: scripts/azure-provision.sh, deployment scripts
# ============================================================================
AZURE_ACR_NAME=${AZURE_RESOURCE_PREFIX}acr
AZURE_ACR_SKU=Basic

# ============================================================================
# AZURE CONTAINER APPS
# ============================================================================
# Serverless container hosting configuration.
# Used by: deployment scripts
# ============================================================================
AZURE_CONTAINER_APP_ENV=${AZURE_RESOURCE_PREFIX}-cae
AZURE_CONTAINER_APP_NAME=suitecrm

# ============================================================================
# DOCKER BUILD CONFIGURATION
# ============================================================================
# Settings for Docker image build-time configuration.
# These variables are used by docker-generate.sh to create Dockerfile and
# docker-compose.yml from templates via envsubst.
# Used by: scripts/docker-generate.sh, Dockerfile.template, docker-compose.template.yml
# ============================================================================

# Base image and versions
DOCKER_PHP_BASE_IMAGE=php:8.3-apache
DOCKER_SUITECRM_VERSION=8.8.0
DOCKER_PLATFORM=linux/amd64

# Container naming (uses DOCKER_PREFIX for consistency)
DOCKER_IMAGE_NAME=${DOCKER_PREFIX}-suitecrm
DOCKER_IMAGE_TAG=latest
DOCKER_CONTAINER_NAME=${DOCKER_PREFIX}-suitecrm-web
DOCKER_NETWORK_NAME=${DOCKER_PREFIX}-suitecrm-network

# Labels
DOCKER_LABEL_MAINTAINER="TheBuzzMagazines DevOps"
DOCKER_LABEL_DESCRIPTION="SuiteCRM Cloud-Native for Azure Container Apps"

# PHP Configuration
DOCKER_PHP_MEMORY_LIMIT=512M
DOCKER_PHP_UPLOAD_MAX_FILESIZE=100M
DOCKER_PHP_POST_MAX_SIZE=100M
DOCKER_PHP_MAX_EXECUTION_TIME=300
DOCKER_PHP_MAX_INPUT_TIME=300
DOCKER_PHP_MAX_INPUT_VARS=10000

# OPcache Configuration
DOCKER_OPCACHE_MEMORY=256
DOCKER_OPCACHE_INTERNED_STRINGS=16
DOCKER_OPCACHE_MAX_FILES=10000

# Ports
DOCKER_HOST_PORT=8080
# Container port matches host port to fix SuiteCRM Route Access self-check
DOCKER_CONTAINER_PORT=8080

# Health check
DOCKER_HEALTHCHECK_INTERVAL=30s
DOCKER_HEALTHCHECK_TIMEOUT=10s
DOCKER_HEALTHCHECK_RETRIES=3
DOCKER_HEALTHCHECK_START_PERIOD=60s
# Healthcheck URL must match container port
DOCKER_HEALTHCHECK_URL=http://localhost:8080/

# Entrypoint behavior
DOCKER_DB_WAIT_MAX_ATTEMPTS=30
DOCKER_DB_WAIT_INTERVAL=5

# ============================================================================
# SUITECRM RUNTIME: MYSQL CONNECTION
# ============================================================================
# How the Docker container CONNECTS to the database at runtime.
# These are passed to docker-entrypoint.sh which generates SuiteCRM config.
# Used by: docker-compose.yml, docker-entrypoint.sh
# ============================================================================
SUITECRM_RUNTIME_MYSQL_HOST=${AZURE_PROVISION_MYSQL_SERVER_NAME}.mysql.database.azure.com
SUITECRM_RUNTIME_MYSQL_PORT=3306
SUITECRM_RUNTIME_MYSQL_NAME=suitecrm
SUITECRM_RUNTIME_MYSQL_USER=suitecrm

# SuiteCRM database password - uses SUITECRM_PASSWORD
SUITECRM_RUNTIME_MYSQL_PASSWORD=[YOUR_SUITECRM_RUNTIME_MYSQL_PASSWORD_HERE]
# Production override (uncomment and customize):
# SUITECRM_RUNTIME_MYSQL_PASSWORD=YourUniqueMySQLPwd4$

# SSL Settings (required for Azure MySQL)
SUITECRM_RUNTIME_MYSQL_SSL_ENABLED=true
SUITECRM_RUNTIME_MYSQL_SSL_VERIFY=true
SUITECRM_RUNTIME_MYSQL_SSL_CA=/etc/ssl/certs/ca-certificates.crt

# ============================================================================
# SUITECRM APPLICATION SETTINGS
# ============================================================================
# Application-level configuration for SuiteCRM.
# Used by: docker-entrypoint.sh
# ============================================================================
# Include port to match Docker host port for Route Access checks
SUITECRM_SITE_URL=http://localhost:8080
SUITECRM_ADMIN_USER=admin

# SuiteCRM admin password - uses SUITECRM_PASSWORD
SUITECRM_ADMIN_PASSWORD=[YOUR_SUITECRM_ADMIN_PASSWORD_HERE]
# Production override (uncomment and customize):
# SUITECRM_ADMIN_PASSWORD=YourUniqueAdminPwd5%

SUITECRM_LOG_LEVEL=debug
SUITECRM_INSTALLER_LOCKED=false

# ============================================================================
# MIGRATION SOURCE: MYSQL (Legacy Advertisers Database)
# ============================================================================
# Connection to the EXISTING MySQL database containing data migrated from
# MS Access. Migration scripts READ from this database.
# Used by: scripts/cli.sh (backup commands), future migration scripts
#
# NOTE: These are LEGACY system credentials - do NOT update to use GLOBAL_*
# ============================================================================
MIGRATION_SOURCE_MYSQL_HOST=localhost
MIGRATION_SOURCE_MYSQL_PORT=3306
MIGRATION_SOURCE_MYSQL_NAME=advertisers
MIGRATION_SOURCE_MYSQL_USER=buzz
MIGRATION_SOURCE_MYSQL_PASSWORD=[YOUR_MIGRATION_SOURCE_MYSQL_PASSWORD_HERE]

# ============================================================================
# MIGRATION DESTINATION: MYSQL (SuiteCRM Database)
# ============================================================================
# Connection to the SuiteCRM database for WRITING migrated data.
# Migration scripts WRITE to this database.
# Used by: future migration scripts
# ============================================================================
MIGRATION_DEST_MYSQL_HOST=localhost
MIGRATION_DEST_MYSQL_PORT=3306
MIGRATION_DEST_MYSQL_NAME=suitecrm
MIGRATION_DEST_MYSQL_USER=suitecrm
# Migration destination password - uses SUITECRM_PASSWORD (same as SuiteCRM DB)
MIGRATION_DEST_MYSQL_PASSWORD=[YOUR_MIGRATION_DEST_MYSQL_PASSWORD_HERE]
# Production override (uncomment and customize):
# MIGRATION_DEST_MYSQL_PASSWORD=YourUniqueMigDestPwd6^

# ============================================================================
# LEGACY MS ACCESS DATABASE (Optional)
# ============================================================================
# Direct connection to the original MS Access database if needed.
# May require ODBC driver and mdbtools on Linux.
# Used by: future migration scripts (if direct Access access is needed)
#
# NOTE: These are LEGACY system credentials - do NOT update to use GLOBAL_*
# ============================================================================
BUZZ_ADVERT_MSACCESS_PATH=/path/to/BuzzAdvertisers.mdb
BUZZ_ADVERT_MSACCESS_DRIVER=MDBTools
BUZZ_ADVERT_MSACCESS_USER=manager
BUZZ_ADVERT_MSACCESS_PASSWORD=[YOUR_BUZZ_ADVERT_MSACCESS_PASSWORD_HERE]

# ============================================================================
# GENERAL CONFIGURATION
# ============================================================================
# Application timezone for Docker containers and Azure resources (southcentralus region)
TZ=America/Chicago
# Skip database wait on container startup (for debugging)
SKIP_DB_WAIT=false

# ============================================================================
# LOGGING CONFIGURATION
# ============================================================================
# Timezone for script logging and log file timestamps
# Separate from TZ to allow logs in a different timezone than the application
LOGGING_TZ=America/New_York

# ============================================================================
# LOCAL AZURE FILES MOUNT PATHS
# ============================================================================
# Where Azure File shares are mounted locally via SMB.
# Used by: docker-compose.yml, scripts/azure-mount.sh
# ============================================================================
AZURE_FILES_MOUNT_BASE=/mnt/azure/suitecrm

# ============================================================================
# BACKUP CONFIGURATION
# ============================================================================
BACKUP_DIR=database/backups
SCHEMA_BACKUP_DIR=database/backups
